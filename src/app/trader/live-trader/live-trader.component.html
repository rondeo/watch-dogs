<div>
    <div>
        <mat-checkbox #allMarkets>All Markets</mat-checkbox>
        &nbsp;&nbsp;
        <mat-checkbox #USDT_BTC>USDT BTC</mat-checkbox>
        &nbsp;&nbsp;
        <mat-checkbox #bots [checked]="true">Bots</mat-checkbox>
        &nbsp;&nbsp;
        <mat-checkbox #botOrders>Orders</mat-checkbox>

        <mat-checkbox #marketCandles>Candles</mat-checkbox>
    </div>
    <br/>
    <div>
        <table>
            <tbody>
            <tr>
                <th>{{marketService.exchange$ | async}}</th>
                <th> {{base}} </th>
                <th> {{coin}} </th>
            </tr>
            <tr>
                <td>
                    <small>Balances:</small>
                </td>
                <td><sup>$</sup> {{balanceBaseUS}} </td>
                <td><sup>$</sup> {{balanceCoinUS}} </td>
            </tr>
            </tbody>
        </table>


        <div>

            <div>
                &nbsp;&nbsp;
                <mat-form-field class="w3">
                    <input matInput
                           [(ngModel)]="amountPots"
                           [type]="'number'"
                           (ngModelChange)="onAmountChanged()"
                           placeholder="Pots"
                    >
                </mat-form-field>
                &nbsp;&nbsp;
                <mat-form-field class="w6">
                    <input matInput
                           [(ngModel)]="price"
                           (ngModelChange)="onPriceChanged()"
                           placeholder="Limit Price">
                </mat-form-field>
                &nbsp;&nbsp;
                <mat-form-field class="w6">
                    <input matInput
                           [(ngModel)]="stopLoss"
                           placeholder="Stop Loss">
                    <mat-hint>{{stopLossPercent}}%</mat-hint>
                </mat-form-field>
                <br/>
                <div>
                    <sub>Books</sub>
                    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                    <sup>SL: </sup>
                    <mat-slider
                            [(ngModel)]="stopLossPercent"
                            (change)="onStopLossPercentChanged()"
                            [thumbLabel]="true"
                            [max]="5"
                            [min]="0.5"
                            [step]="0.25"
                    ></mat-slider>
                    <br/>
                    <span
                            (click)="onPriceBuyClick()"
                    >{{marketService.priceBuy$ | async}}</span>
                    &nbsp;&nbsp;
                    <span
                        (click)="onRefreshBooksClick()"
                ><mat-icon>cached</mat-icon></span>
                    &nbsp;&nbsp;
                    <span
                            (click)="onPriceSellClick()"
                    >{{marketService.priceSell$ | async}}</span>

                </div>
            </div>
        </div>

        <br/>
        <div>
            <button mat-raised-button class="green-color" (click)="onBuyClick()">Buy</button>

            &nbsp;&nbsp;
            <button mat-raised-button color="accent" (click)="onSellClick()">Sell</button>
        </div>
    </div>


    <div *ngIf="allMarkets.checked">

        <mat-form-field>
            <mat-label>Exchange</mat-label>
            <mat-select
                    [(ngModel)]="exchange"
                    (ngModelChange)="onExchangeChanged($event)"
            >
                <mat-option
                        *ngFor="let exchange of (marketService.exchanges$ | async)" [value]="exchange"
                >
                    {{exchange}}
                </mat-option>
            </mat-select>
        </mat-form-field>

        &nbsp;&nbsp;

        <mat-form-field>
            <mat-label>Market</mat-label>
            <mat-select
                    [(ngModel)]="market"
                    (ngModelChange)="onMarketChanged($event)"
            >
                <mat-option
                        *ngFor="let market of (marketService.markets$ | async)" [value]="market">
                    {{market}}
                </mat-option>
            </mat-select>
        </mat-form-field>
    </div>


    <div *ngIf="USDT_BTC.checked">
        <h3>USDT-BTC</h3>
        <table role="list">
            <tbody>
            <tr>
                <td></td>
                <td>BTC</td>
                <td>USDT</td>
                <td (click)="onUsdClick()">USD</td>
            </tr>
            <tr
                    role="listitem"
                    *ngFor="let usdtbtc of (usdtbtcs$ | async)" (click)="onUsdtBtcClick(usdtbtc)"
            >
                <td>
                    {{usdtbtc.exchange}}
                </td>
                <td>
                    {{usdtbtc.btc.balance | coin2us:'BTC' | async}}
                </td>
                <td>
                    {{usdtbtc.usdt.balance | coin2us:'USDT' | async}}
                </td>
                <td>
                    {{usdtbtc.usd.balance | coin2us:'USD' | async}}
                </td>

            </tr>
            </tbody>

        </table>
    </div>

    <div *ngIf="bots.checked">
        <h3>Bots</h3>
        <table>
            <tbody>
            <tr class="small">
                <td class="w10">ID</td>
                <td>pots</td>
                <td class="w6">Entry</td>
                <td class="w7">Liquid</td>
                <td class="w6">Last</td>
                <td class="w6">Sell Price</td>
                <td class="w6">Sell</td>
                <td>edit</td>
                <td>Del</td>
            </tr>
            <tr *ngFor="let bot of (bots$ | async)">
                <td (click)="onBotClick(bot)" class="small">{{bot.id}}</td>
                <td>{{bot.pots$ | async}}</td>
                <td>{{bot.priceEntry$ | async}}</td>
                <td>
                    <span
                            *ngIf="!bot.isPriceLiquidEdit"
                            (click)="onPriceLiquidClick(bot)"
                    >{{bot.priceLiqud$ | async}} </span>
                    <span *ngIf="bot.isPriceLiquidEdit">
                          <input class="w5" type="text" [(ngModel)]="bot.priceLiquidInput">
                                &nbsp;
                        <small>
                             <mat-icon [inline]="true" (click)="onCurrentLiquidSaveClick(bot)"
                                       class="btn">save</mat-icon>
                            <mat-icon [inline]="true" (click)="onCancelEditClick(bot)" class="btn">clear</mat-icon>
                        </small>
                    </span>
                </td>
                <td>
                    {{bot.lastPrice$ | async}}
                </td>
                <td>
                    <span (click)="onBotPriceSellClick(bot)">{{bot.priceSell$ | async}}</span>
                </td>
                <td><button (click)="onBotSellClick(bot)" >Sell</button></td>

                <td><mat-icon [ngClass]="bot.isLive?'red':''" class="btn" (click)="onEditClick(bot)">edit</mat-icon></td>
                <td (click)="onDeleteBotClick(bot)">X</td>
            </tr>
            </tbody>
        </table>
    </div>

    <div *ngIf="botOrders.checked">
        <h3>Active orders</h3>
        <table>
            <tbody>
            <tr *ngFor="let ord of (myOrders$ | async)">
                <td>{{ord.orderType}}</td>
                <td>{{ord.amountUS}}</td>
                <td>{{ord.rate}}</td>
                <td>{{ord.isOpen}}</td>
                <td (click)="onDeleteOrderClick(ord)">X</td>
            </tr>
            </tbody>
        </table>
    </div>

    <div *ngIf="marketCandles.checked" >

        <app-market-candles [market]="market" [exchange]="exchange"></app-market-candles>


    </div>

</div>
